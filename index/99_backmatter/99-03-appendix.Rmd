# Supporting Information: Chapter \@ref(density) {#density-app}

\newpage

```{r density-app-setup, echo=FALSE}
#Set the default theme for ggplot objects to theme_bw()
theme_set(theme_bw())
theme_update(panel.grid = element_blank())
```

```{r density-load-prep-data, echo=FALSE}
# load camera-trap station info
records <- read.csv("data/density/spp_records_pa.csv")
records_otways <- records[which(records$region == "otways"),] 
records_glenelg <- records[which(records$region == "glenelg"),]
# lower glenelg fox records
records_lg <- read.csv("data/density/lower_glenelg_fox_pa.csv")
# load masks as dataframes (for covariates)
otways_mask_df <- readRDS("data/density/otway_mask_df.RData")
glenelg_mask_df <- readRDS("data/density/glenelg_mask_df.RData")
# load SECR capture histories - each session (but seperate unID from unmarked)
# mt clay (no black cats)
ch_mc <- readRDS("data/density/ch_mc.RData")
unid_mc <- as.matrix(read.csv("data/density/unid_mc.csv")[, -1]) 
mrch_mc <- addSightings(ch_mc, uncertain = unid_mc)
# hotspur 
ch_h <- readRDS("data/density/ch_h.RData")
unid_h <- as.matrix(read.csv("data/density/unid_h.csv")[, -1]) 
unm_h <- as.matrix(read.csv("data/density/unm_h.csv")[, -1]) 
mrch_h <- addSightings(ch_h, unmarked = unm_h, uncertain = unid_h)
# annya 
ch_a <- readRDS("data/density/ch_a.RData")
unid_a <- as.matrix(read.csv("data/density/unid_a.csv")[, -1]) 
unm_a <- as.matrix(read.csv("data/density/unm_a.csv")[, -1]) 
mrch_a <- addSightings(ch_a, unmarked = unm_a, uncertain = unid_a)
# cobbob 
ch_c <- readRDS("data/density/ch_c.RData")
unid_c <- as.matrix(read.csv("data/density/unid_c.csv")[, -1]) 
unm_c <- as.matrix(read.csv("data/density/unm_c.csv")[, -1]) 
mrch_c <- addSightings(ch_c, unmarked = unm_c, uncertain = unid_c)
# LGNP north
ch_lgnpn <- read.capthist(captfile = "data/density/LGNPN_caphist.txt", trapfile = "data/density/LGNPN_traps.txt", detector = "proximity")
# LGNP south
ch_lgnps <- read.capthist(captfile = "data/density/LGNPS_caphist.txt", trapfile = "data/density/LGNPS_traps.txt", detector = "proximity")
# northern grid 2017 
ch_n_17 <- readRDS("data/density/ch_n_17.RData")
unid_n_17 <- as.matrix(read.csv("data/density/unid_n_17.csv")[, -1]) 
unm_n_17 <- as.matrix(read.csv("data/density/unm_n_17.csv")[, -1]) 
mrch_n_17 <- addSightings(ch_n_17, unmarked = unm_n_17, uncertain = unid_n_17)
# northern grid 2018 
ch_n_18 <- readRDS("data/density/ch_n_18.RData")
unid_n_18 <- as.matrix(read.csv("data/density/unid_n_18.csv")[, -1]) 
unm_n_18 <- as.matrix(read.csv("data/density/unm_n_18.csv")[, -1]) 
mrch_n_18 <- addSightings(ch_n_18, unmarked = unm_n_18, uncertain = unid_n_18)
# northern grid 2019 
ch_n_19 <- readRDS("data/density/ch_n_19.RData")
unid_n_19 <- as.matrix(read.csv("data/density/unid_n_19.csv")[, -1]) 
unm_n_19 <- as.matrix(read.csv("data/density/unm_n_19.csv")[, -1]) 
mrch_n_19 <- addSightings(ch_n_19, unmarked = unm_n_19, uncertain = unid_n_19)
# southern grid 2017 
ch_s_17 <- readRDS("data/density/ch_s_17.RData")
unid_s_17 <- as.matrix(read.csv("data/density/unid_s_17.csv")[, -1]) 
unm_s_17 <- as.matrix(read.csv("data/density/unm_s_17.csv")[, -1]) 
mrch_s_17 <- addSightings(ch_s_17, unmarked = unm_s_17, uncertain = unid_s_17)
# southern grid 2018 
ch_s_18 <- readRDS("data/density/ch_s_18.RData")
unid_s_18 <- as.matrix(read.csv("data/density/unid_s_18.csv")[, -1]) 
unm_s_18 <- as.matrix(read.csv("data/density/unm_s_18.csv")  [, -1]) 
mrch_s_18 <- addSightings(ch_s_18, unmarked = unm_s_18, uncertain = unid_s_18)
# southern grid 2019 
ch_s_19 <- readRDS("data/density/ch_s_19.RData")
unid_s_19 <- as.matrix(read.csv("data/density/unid_s_19.csv")[, -1]) 
unm_s_19 <- as.matrix(read.csv("data/density/unm_s_19.csv")[, -1]) 
mrch_s_19 <- addSightings(ch_s_19, unmarked = unm_s_19, uncertain = unid_s_19)
# combine capthists per region
mrch_glenelg <- MS.capthist(mrch_a, mrch_c, mrch_h, mrch_mc, ch_lgnpn, ch_lgnps)
mrch_otways <- MS.capthist(mrch_n_17, mrch_s_17, mrch_n_18, mrch_s_18, mrch_n_19, mrch_s_19)
mrch <- MS.capthist(mrch_a, mrch_c, mrch_h, mrch_mc, ch_lgnpn, ch_lgnps, mrch_n_17, mrch_s_17, mrch_n_18, mrch_s_18, mrch_n_19, mrch_s_19)
# load masks
masks <- readRDS("data/density/masks.RData")
# load SECR models
df_fits_glenelg <- readRDS("data/density/glenelg_df_fits.RData")
glenelg_fits <- readRDS("data/density/glenelg_fits.RData")
glenelg_set1 <- readRDS("data/density/glenelg_set1.RData")
glenelg_set2 <- readRDS("data/density/glenelg_set2.RData")
glenelg_set3 <- readRDS("data/density/glenelg_set3.RData")
df_fits_otways <- readRDS("data/density/otways_df_fits.RData")
otways_fits <- readRDS("data/density/otways_fits.RData")
otways_set1 <- readRDS("data/density/otways_set1.RData")
otways_set2 <- readRDS("data/density/otways_set2.RData")
otways_set3 <- readRDS("data/density/otways_set3.RData")
# load GAMs
gam_g_fox <- readRDS("data/density/gam_g_fox.RData")
gam_o_fox <- readRDS("data/density/gam_o_fox.RData")
```

## Field surveys {#density-app-field}

In the Glenelg region, we deployed camera-traps once at a unique sites once. In the Otway region, we redeployed camera-traps in sites annually for three years. All 2017 camera-sites were resurveyed each year, except for four logistically challenging sites in the southern grid. In 2018, we added 16 additional sites in the southern grid, as well as 36 additional sites in the northern grid. These additional sites were resurveyed in 2019. 

At each site, we deployed a singular remote trail camera with infrared flash and temperature-in-motion detector. The vast majority of camera-traps were Reconyx Hyperfire HC600, but a small portion was made up of both PC900 and HF2X infrared models (Reconyx, Holmen, Wisconsin). We programmed camera’s to the highest sensitivity and to take five consecutive photographs when triggered (no quiet period). We attached each camera to a tree, approximately 30 cm above the ground, and facing toward a lure 2 - 2.5 metres away. The lure comprised an oil-absorbing cloth doused in tuna oil and placed inside a PVC pipe container with a mesh top. We secured each lure to the top of a 1 metre wooden stake and attached a handful of small white feathers to the outside of the PVC pipe container. Feathers were not used in the Lower Glenelg National Park survey. We cleared vegetation in the camera’s line-of-sight to reduce false triggers and avoid obscuring cat coat markings in images. 

\newpage

$~$

$~$

$~$


```{r, density-camop, fig.cap = "Camera-trap operation times in the Otway region, Australia. Each blue horizontal line represents one camera-trap deployment. Grey shading indicates periods of fox control in the impact landscape."}
#fig.height = 3, fig.width=4.5,
par(mfrow = c(1,1), mar = c(2.6, 2.1, 2.1, 2.1))
## OTWAYS
records_otways <- arrange(records_otways, date_start)
camop_otways    <- cameraOperation(CTtable = records_otways,  stationCol = "station_year", setupCol = "date_start", retrievalCol = "date_end", writecsv = FALSE, hasProblems = FALSE, dateFormat = "%Y-%m-%d")
camOp <- camop_otways
which.tmp <- grep(as.Date(colnames(camOp)), pattern = "01$")
label.tmp <- format(as.Date(colnames(camOp))[which.tmp], "%Y-%m")
at.tmp <- which.tmp / ncol(camOp)
values_tmp <- sort(na.omit(unique(c(camOp))))
image(t(as.matrix(camOp)), xaxt = "n", yaxt = "n", col = "#1b98e0")
axis(1, at = at.tmp, labels = label.tmp)
# axis(2, at = seq(from = 0, to = 1, length.out = nrow(camOp)), labels = NA, las = 1)
abline(v = at.tmp, col = rgb(0,0,0, 0.1))
# plot baiting schedule
polygon(x = c(0.18, 0.458, 0.458, 0.18), y = c(0, 0, 2, 2), col = "grey80")  
polygon(x = c(0.68, 1, 1, 0.68), y = c(0, 0, 2, 2), col = "grey80")  
#replot cams
image(t(as.matrix(camOp)), xaxt = "n", yaxt = "n", col = "#1b98e0", add = TRUE)
abline(v = at.tmp, col = rgb(0,0,0, 0.1))
#mtext("b", side = 3, line = 1, at = 0)
```

\newpage

$~$

$~$

$~$

```{r density-cam-photo, fig.cap = "Example of a typical camera-trap set-up in the Otway region, Australia."}
knitr::include_graphics("figure/camtrap1.jpg")
```

\newpage

## Individual cat identification {#density-app-id}

We first labelled every camera-trap image with a species metadata tag using [DigiKam software](https://www.digikam.org){target="_blank"}. We also added metadata tags for each cat coat type: black, mackerel tabby, classic tabby, ginger and other (coats with multiple colour blends; Fig. 3). This allowed us to summarise species records and extract cat images using the 'camtrapR' R-package [@niedballa2016].

We considered all black cats to be of the 'unmarked' category in spatial mark-resight models - even the few with white splotches on their underside (as these couldn't always be seen as cats move with their head down).

In the remaining coat categories where possible, we identified individual cats based on their unique coat markings. The ability to identify individuals substantially increased as the image library for each cat increased. Therefore we made the easiest identifications first to build up these libraries, before making decisions on the less obvious detections. We examined and matched all coat markings seen between two particular defections. Markings on the front legs were the most useful for ID's as the patterns do not skew as much with different body positions. On the whole, unidentifiable detections were mainly due to only part of a cat appearing in the frame, or because photos were blurry (because of cat movement or a foggy camera lens).

We were left with a small number of instances (less than ten) where only left or right flanks could be seen. In this case, the side with the most repeat detections was labelled as an individual, whereas the side with the least number of detections was considered unidentifiable. Additionally, an extremely small portion of cats in the Otways had ginger coats. When ginger coats are photographed with an infrared flash, they become overexposed and no markings can be seen (see the image in bottom-right corner in Fig. S3). Therefore, if there were multiple ginger cat detections in a single grid, we treated them in the same way as one-sided flank detections.

One observer identified the 2018 feral cats in the Glenelg region (MR) and the 2021 Lower Glenelg National Park cats (Luke Woodford). In the 2017 and 2018 Otway datasets (where there were substantially more cat detections and fewer distinct coat patterns) two independent observers identified individual cats and discrepancies between observers were reviewed together until consensus was reached (MR, MLP, BH). If no consensus was reached, the cat was considered unidentifiable. In the 2019 Otway dataset, many of the identified cats were sighted in the previous surveys – these larger individual libraries meant that cats could be identified more easily so only one observer was necessary (MR). We also identified individual cats in additional camera-trap surveys taken within the Otway region grids (just before each of our surveys) using white flash camera-traps (Zoï Banikos, unpublished data), providing additional images of individuals in the photo library for identifications.

We were therefore left with three groups of cats: unmarked (black cats), marked (cats which could be identified to the individual-level with complete certainty) and mark status unknown (cats which were not black, but couldn't be identified to the individual level with complete certainty).

We ignored the few detections of cats which were obviously young enough to be dependent on a parent, as these kittens do not have independent activity centres or movements and were not yet recruited into the adult population. 

\newpage

$~$

$~$

$~$

```{r density-cat-photo, fig.cap="Feral cat coat categories from left-right, top-bottom: black, mackerel tabby, classic tabby, other, black, ginger and ginger with infrared flash."}
knitr::include_graphics("figure/cat_coats.jpg")
```


\newpage

## Summary statistics 

$~$

$~$

$~$

```{r density-stats}
# clean LGNP records for merge
# add grid 
records_lg$st_no <- records_lg$station
records_lg$st_no <- as.integer(gsub('LGNP', "", records_lg$st_no))
records_lg$grid  <- if_else(as.integer(records_lg$station) >= 65, "LGNP_n", "LGNP_s")
# add station_year
records_lg$station_year <- paste0(records_lg$station, "_2021")
## merge LGNP records with other records
records <- bind_rows(records, records_lg)
# add grid variable for gam data
records$grid  <- if_else(grepl("^A", records$station), "Annya", records$grid)
records$grid  <- if_else(grepl("^C", records$station), "Hotspur", records$grid)
records$grid  <- if_else(grepl("^H", records$station), "Cobbob", records$grid)
records$grid  <- if_else(grepl("^M", records$station), "Mt Clay", records$grid)
records$grid  <- if_else(grepl("^T", records$station), "S", records$grid)
records$grid  <- if_else(grepl("^U", records$station), "N", records$grid)
records$grid <- if_else(as.character(records$region) == "otways", paste0(records$grid, "_", records$year), records$grid)
## MAKE TABLE
# transpose summaries as a dataframe and bind together
g <- t(as.data.frame(summary(mrch_glenelg, terse = TRUE, moves = TRUE))) 
o <- t(as.data.frame(summary(mrch_otways, terse = TRUE, moves = TRUE)))
go <- as.data.frame(rbind(g,o))
go <- tibble::rownames_to_column(go, "Grid")
# add region column
go$Region <- c(rep("Glenelg", 6), rep("Otways", 6))
# add other detections
go$Unidentified_detections <- c(3,  9,  3,  5, 0, 0,  8, 4, 12, 17, 22, 23)
go$Unmarked_detections     <- c(20, 37, 13, 0, 0, 0, 46, 48, 62, 59, 101, 58)
go$Total_detections <- go$Detections + go$Unidentified_detections + go$Unmarked_detections
# change name of grids
new_grid_names <- c(mrch_a = "Annya", mrch_c ="Cobbob", mrch_h = "Hotspur", mrch_mc = "Mt Clay", ch_lgnpn = "LGNP north", ch_lgnps = "LGNP south", mrch_s_17 = "South 2017", mrch_n_17 = "North 2017", mrch_s_18 = "South 2018", mrch_n_18 = "North 2018", mrch_s_19 = "South 2019", mrch_n_19 = "North 2019")
go$Grid <- as.character(new_grid_names[go$Grid])
# add trapnights
records <- records %>% 
  group_by(grid) %>% 
  mutate(trapnights = sum(survey_duration))
# out of order so do this manually 
# unique(records$trapnights)
go$Trap_nights <- c(8000, 7752, 6085, 5451, 2102, 2842, 3565, 7099, 7838, 4543, 6077, 7150)
# add fox control column
#go$Fox_baited <- c("no", "yes", "no", "yes", "no", "yes", "no", "no", "lapsed", "no", "yes", "no")
# get rid of occasions - not informative (as trap nights), total detections
go <- subset(go, select = -c(Occasions, Total_detections, Region))
# reorder 
go <- go[,c("Grid", "Detectors", "Trap_nights", "Animals", "Moves", "Detections", "Unidentified_detections", "Unmarked_detections")]
# make table
kbl(go, booktabs = TRUE, longtable = TRUE,
    col.names = c("Landscape", "Cameras", "Trapnights", "Cats", "Moves", "Identified", "Unidentified", "Unmarked"),
    caption = "Summary of camera-trap survey effort and feral cat detections.") %>% 
   add_header_above(c(" " = 5, "Detections (max. 1 per 24-hr)" = 3)) %>% 
   kable_styling(latex_options = c("repeat_header"), font_size = 10) 
```

\newpage

## Feral cat detection plots 

### Glenelg region

#### Replicate 1 

$~$

$~$

$~$

```{r density-plot-ch-1, fig.cap = "Feral cat detections in the first replicate grid pair in the Glenelg region, Australia. Camera-traps are indicated by red crosses. Solid fill coloured circles represent identified cats with lines indicating observed movements. Black open circles indicate black cat detections; blue circles indicate unidentifiable tabby cat detections, with circle radius scaling positively with the number of daily detections. Fox control does not occur in Annya (a) but does in Cobboboonee (b)."}
par(mfrow = c(1,2), mar = c(2.6, 1, 2.1, 1))
plot(mrch_a, rad = 2, tracks = T, bg = "white", detpar = list(col = "black"), title = "a) Annya State Forest", icolours = brewer.pal(12, "Paired"), randcol = TRUE, gridlines = FALSE, cappar = list(cex = 2), border = 10)
sightingPlot(mrch_a, type = "Tu", add = TRUE, scale = 200, mean = FALSE, px = 1.1, py = 1.9, title = "", col = "black")
sightingPlot(mrch_a, type = "Tn", add = TRUE, scale = 200, mean = FALSE, px = 1.1, py = 1.9, title = "", col = "blue")
plot(mrch_c, rad = 2, tracks = T, bg = "white", detpar = list(col = "black"), title = "b) Cobboboonee National Park", icolours = brewer.pal(12, "Paired"), randcol = TRUE, gridlines = FALSE, cappar = list(cex = 2), border = 10)
sightingPlot(mrch_c, type = "Tu", add = TRUE, scale = 200, mean = FALSE, px = 1.1, py = 1.9, title = "", col = "black")
sightingPlot(mrch_c, type = "Tn", add = TRUE, scale = 200, mean = FALSE, px = 1.1, py = 1.9, title = "", col = "blue")
```

\newpage

#### Replicate 2

$~$

$~$

$~$

```{r density-plot-ch-2,  fig.cap = "Feral cat detections in the second replicate grid pair in the Glenelg region, Australia. Camera-traps are indicated by red crosses. Solid fill coloured circles represent identified cats with lines indicating observed movements. Black open circles indicate black cat detections; blue circles indicate unidentifiable tabby cat detections, with circle radius scaling positively with the number of daily detections. Fox control does not occur in Hotspur (a) but does in Mt Clay (b)."}
par(mfrow = c(1,2), mar = c(2.6, 1, 2.1, 1))
plot(mrch_h, rad = 2, tracks = T, bg = "white", detpar = list(col = "black"), title = "a) Hotspur State Forest", icolours = brewer.pal(12, "Paired"), randcol = TRUE, gridlines = FALSE, cappar = list(cex = 2), border = 10)
sightingPlot(mrch_h, type = "Tu", add = TRUE, scale = 200, mean = FALSE, px = 1.1, py = 1.9, title = "", col = "black")
sightingPlot(mrch_h, type = "Tn", add = TRUE, scale = 200, mean = FALSE, px = 1.1, py = 1.9, title = "", col = "blue")
plot(mrch_mc, rad = 2, tracks = T, bg = "white", detpar = list(col = "black"), title = "b) Mt Clay Reserve", icolours = brewer.pal(12, "Paired"), randcol = TRUE, gridlines = FALSE, cappar = list(cex = 2), border = 10)
sightingPlot(mrch_mc, type = "Tn", add = TRUE, scale = 200, mean = FALSE, px = 1.1, py = 1.9, title = "", col = "blue")
```

\newpage

#### Replicate 3

$~$

$~$

$~$

```{r density-plot-ch-3,  fig.cap = "Feral cat detections in the third replicate grid pair in the Glenelg region, Australia. Camera-traps are indicated by red crosses. Solid fill coloured circles represent identified cats with lines indicating observed movements. Fox control does not occur in the north (a) but does in the south (b)."}
par(mfrow = c(1,2), mar = c(2.6, 1, 2.1, 1))
plot(ch_lgnpn, rad = 2, tracks = T, bg = "white", detpar = list(col = "black"), title = "a) Lower Glenelg National Park - north", icolours = brewer.pal(12, "Paired"), randcol = TRUE, gridlines = FALSE, cappar = list(cex = 2), border = 10)
plot(ch_lgnps, rad = 2, tracks = T, bg = "white", detpar = list(col = "black"), title = "a) Lower Glenelg National Park - south", icolours = brewer.pal(12, "Paired"), randcol = TRUE, gridlines = FALSE, cappar = list(cex = 2), border = 10)
```

\newpage

### Otway region
#### 2017

$~$

$~$

$~$

```{r density-plot-ch-4,    fig.cap = "Feral cat detections in the Otway region, Australia, 2017. Solid fill coloured circles represent identified cats with lines indicating observed movements. Black open circles indicate black cat detections; blue circles indicate unidentifiable tabby cat detections, with circle radius scaling positively with the number of daily detections. Fox control did not occur in either of the landscapes during this time."}
par(mfrow = c(1,2), mar = c(2.6, 1, 2.1, 1))
plot(mrch_n_17, rad = 2, tracks = T, bg = "white", detpar = list(col = "black"), title = "a) Otways north 2017", icolours = brewer.pal(12, "Paired"), randcol = TRUE, gridlines = FALSE, cappar = list(cex = 2), border = 10)
sightingPlot(mrch_n_17, type = "Tu", add = TRUE, scale = 200, mean = FALSE, px = 1.1, py = 1.9, title = "", col = "black")
sightingPlot(mrch_n_17, type = "Tn", add = TRUE, scale = 200, mean = FALSE, px = 1.1, py = 1.9, title = "", col = "blue")
plot(mrch_s_17, rad = 2, tracks = T, bg = "white", detpar = list(col = "black"), title = "b) Otways south 2017", icolours = brewer.pal(12, "Paired"), randcol = TRUE, gridlines = FALSE, cappar = list(cex = 2), border = 10)
sightingPlot(mrch_s_17, type = "Tu", add = TRUE, scale = 200, mean = FALSE, px = 1.1, py = 1.9, title = "", col = "black")
sightingPlot(mrch_s_17, type = "Tn", add = TRUE, scale = 200, mean = FALSE, px = 1.1, py = 1.9, title = "", col = "blue")
```

\newpage

#### 2018

$~$

$~$

$~$

```{r density-plot-ch-5,  fig.cap = "Feral cat detections in the Otway region, Australia, 2018. Solid fill coloured circles represent identified cats with lines indicating observed movements. Black open circles indicate black cat detections; blue circles indicate unidentifiable tabby cat detections, with circle radius scaling positively with the number of daily detections. Fox control had occurred, but lapsed just prior to the survey in the northern landscape (a), and did not occur in the southern landscape (b)."}
par(mfrow = c(1,2), mar = c(2.6, 1, 2.1, 1))
plot(mrch_n_18, rad = 2, tracks = T, bg = "white", detpar = list(col = "black"), title = "a) Otways north 2018", icolours = brewer.pal(12, "Paired"), randcol = TRUE, gridlines = FALSE, cappar = list(cex = 2), border = 10)
sightingPlot(mrch_n_18, type = "Tu", add = TRUE, scale = 200, mean = FALSE, px = 1.1, py = 1.9, title = "", col = "black")
sightingPlot(mrch_n_18, type = "Tn", add = TRUE, scale = 200, mean = FALSE, px = 1.1, py = 1.9, title = "", col = "blue")
plot(mrch_s_18, rad = 2, tracks = T, bg = "white", detpar = list(col = "black"), title = "b) Otways south 2018", icolours = brewer.pal(12, "Paired"), randcol = TRUE, gridlines = FALSE, cappar = list(cex = 2), border = 10)
sightingPlot(mrch_s_18, type = "Tu", add = TRUE, scale = 200, mean = FALSE, px = 1.1, py = 1.9, title = "", col = "black")
sightingPlot(mrch_s_18, type = "Tn", add = TRUE, scale = 200, mean = FALSE, px = 1.1, py = 1.9, title = "", col = "blue")
```

\newpage

#### 2019

$~$

$~$

$~$

```{r density-plot-ch-6,  fig.cap = "Feral cat detections in the Otway region, Australia, 2019. Solid fill coloured circles represent identified cats with lines indicating observed movements. Black open circles indicate black cat detections; blue circles indicate unidentifiable tabby cat detections, with circle radius scaling positively with the number of daily detections. Fox control occurred in the northern landscape (a) during this survey, but not the southern landscape (b)."}
par(mfrow = c(1,2), mar = c(2.6, 1, 2.1, 1))
plot(mrch_n_19, rad = 2, tracks = T, bg = "white", detpar = list(col = "black"), title = "a) Otways north 2019", icolours = brewer.pal(12, "Paired"), randcol = TRUE, gridlines = FALSE, cappar = list(cex = 2), border = 10)
sightingPlot(mrch_n_19, type = "Tu", add = TRUE, scale = 200, mean = FALSE, px = 1.1, py = 1.9, title = "", col = "black")
sightingPlot(mrch_n_19, type = "Tn", add = TRUE, scale = 200, mean = FALSE, px = 1.1, py = 1.9, title = "", col = "blue")
plot(mrch_s_19, rad = 2, tracks = T, bg = "white", detpar = list(col = "black"), title = "b) Otways south 2019", icolours = brewer.pal(12, "Paired"), randcol = TRUE, gridlines = FALSE, cappar = list(cex = 2), border = 10)
sightingPlot(mrch_s_19, type = "Tu", add = TRUE, scale = 200, mean = FALSE, px = 1.1, py = 1.9, title = "", col = "black")
sightingPlot(mrch_s_19, type = "Tn", add = TRUE, scale = 200, mean = FALSE, px = 1.1, py = 1.9, title = "", col = "blue")
```

\newpage

## Fox spatial occurrence {#density-app-fox}

### Glenelg region

$~$

$~$

$~$

```{r, }
summary(gam_g_fox)
```

\newpage

$~$

$~$

$~$

```{r density-fox-se-g,  fig.cap = "Standard error estimate of log fox occurrence probability derived from generalised additive models within each impact (I) and associated non-impact (NI) landscape in the Glenelg region, Australia."}
knitr::include_graphics("figure/fox_occ_se_glenelg_600dpi.png")
```

\newpage

### Otway Region 

$~$

$~$

$~$

```{r, }
summary(gam_o_fox)
```

\newpage

$~$

$~$

$~$

```{r density-fox-se-o, fig.width = 11, fig.cap = "Standard error estimate of log fox occurrence probability derived from generalised additive models within each impact (I) and associated non-impact (NI) landscape in the Otway region, Australia."}
knitr::include_graphics("figure/fox_occ_se_otways_600dpi.png")
```

\newpage

## Vegetation categories {#density-app-veg}

We condensed the main Ecological Vegetation Class groupings [@delwp2020bioregions] present into three categories for each region: cleared land, heathy woodlands, lowland forests (Glenelg region only) and wet forests (Otways region only). We merged similar groups to reduce the number of categories for each region. In the Glenelg region, we merged dry forests with lowland forests. In the Otway region, we merged rainforests with wet forests, as well as merged dry forests and heathy woodlands. 

A very small proportion of other Ecological Vegetation Class groupings were present in the habitat masks: riparian scrubs or swampy scrubs and woodlands, coastal scrubs grasslands and woodlands, wetlands, riverine grassy woodlands or forests, plains woodlands or forests, herb-rich woodlands. We removed these groups, and interpolated cell values from the nearest of the three vegetation categories. 

\newpage

$~$

$~$

$~$

```{r density-veg,  fig.cap="Condensed Ecological Vegetation Class groups used as habitat mask covariates in spatial mark-resight models."}
# plot Vegetation class - glenelg
forestcol <- terrain.colors(6, rev = TRUE)[c(1,5,3)]
names(masks) <- c("Annya", "Cobboboonee", "Hotspur", "Mt Clay", "LGNP north", "LGNP south", "Otways: North", "Otways: South", "Otways: North '18", "Otways: South '18", "Otways: North '19", "Otways: South '19")
par (mfrow = c(2, 5), mar = c(0,0,5,0))
for (sess in 1:6) {
  plot(masks[[sess]], covariate = 'vegetation', legend = FALSE, dots = FALSE, border = 100, col = forestcol) 
  plotMaskEdge((mrch)[[sess]], add = TRUE, plt = TRUE)
  plot(traps(mrch)[[sess]], add = TRUE, detpar = list(pch = 16, cex = 0.25, col = "black"))
  mtext(side=3, paste(session(masks)[[sess]])) }
# plot Vegetation class - otways
forestcol <- terrain.colors(6, rev = TRUE)[c(1,3,6)]
for (sess in 7:8) {
  plot(masks[[sess]], covariate = 'vegetation', legend = FALSE, dots = FALSE, border = 100, col = forestcol) 
  plotMaskEdge((mrch)[[sess]], add = TRUE, plt = TRUE)
  plot(traps(mrch)[[sess]], add = TRUE, detpar = list(pch = 16, cex = 0.25, col = "black"))
  mtext(side=3, paste(session(masks)[[sess]])) }
# null plots for seperate legend
plot(NULL ,xaxt='n',yaxt='n',bty='n',ylab='',xlab='', xlim=0:1, ylim=0:1)
plot(NULL ,xaxt='n',yaxt='n',bty='n',ylab='',xlab='', xlim=0:1, ylim=0:1)
# legend
legend (x = "left", fill = terrain.colors(6, rev = TRUE)[c(1,5,3,6)], legend = c("Cleared", "Dry Forest", "Heathy", "Wet Forest"), bty='n', title = "Vegetation type", pt.cex=3, cex=1.2)
```

\newpage

## Spatial mark-resight models 

### Glenelg region 

$~$

$~$

$~$

```{r density-aic-g-1}
## set 1
df_fits_glenelg_aic <- AIC(df_fits_glenelg, criterion = "AICc")[,-2]
df_fits_glenelg_aic <- subset(df_fits_glenelg_aic, select = -c(model))
df_fits_glenelg_aic$logLik <- round(df_fits_glenelg_aic$logLik, digits = 2)
df_fits_glenelg_aic$AIC    <- round(df_fits_glenelg_aic$AIC, digits = 2)
df_fits_glenelg_aic$AICc   <- round(df_fits_glenelg_aic$AICc, digits = 2)
df_fits_glenelg_aic$dAICc   <- round(df_fits_glenelg_aic$dAICc, digits = 2)
df_fits_glenelg_aic$AICcwt  <- round(df_fits_glenelg_aic$AICcwt, digits = 2)
df_fits_glenelg_aic <- tibble::rownames_to_column(df_fits_glenelg_aic, "fit")
df_fits_glenelg_aic$fit <- ifelse(df_fits_glenelg_aic$fit == "fit1_ex", "exponential", "half-normal")
# table
kbl(df_fits_glenelg_aic, booktabs = TRUE, longtable = TRUE, digits  =2,
       col.names = c("Detector function", "K", "logLik", "AIC", "AICc", "dAICc", "AICcwt"),
    caption = "Akaike's Information Criterion values adjusted for small sample size for feral cat density models in the Glenelg region; model set 1.") %>% 
   kable_styling(font_size = 10) %>% 
footnote(general = c("K - number of parameters", 
                     "AICc - Akaike's Information Criterion with small-sample adjustment",
                     "dAICc - difference between AICc of this model and the model with smallest AICc",
                     "AICcwt - AICc model weight"),
         general_title = "")
```

\newpage

$~$

$~$

$~$

```{r density-aic-g-2}
## set 2
glenelg_set1_tab <- AIC(glenelg_set1, criterion = "AICc")[,-2]
rownames(glenelg_set1_tab) <- NULL
# make table
kbl(glenelg_set1_tab, booktabs = TRUE, longtable = TRUE, digits  =2,
       col.names = c("Model", "K", "logLik", "AIC", "AICc", "dAICc", "AICcwt"),
    caption = "Akaike's Information Criterion values adjusted for small sample size for feral cat density models in the Glenelg region; model set 2.") %>% 
   kable_styling(font_size = 10) %>% 
footnote(general = c("K - number of parameters", 
                     "AICc - Akaike's Information Criterion with small-sample adjustment",
                     "dAICc - difference between AICc of this model and the model with smallest AICc",
                     "AICcwt - AICc model weight",
                     "T - linear time trend (g0 only)"),
         general_title = "")
```


\newpage

$~$

$~$

$~$


```{r density-aic-g-3}

## set 3
glenelg_set2_tab <- AIC(glenelg_set2, criterion = "AICc")[,-2]
rownames(glenelg_set2_tab) <- NULL
glenelg_set2_tab$model <- gsub("predicted_trapcov", "occ", glenelg_set2_tab$model)
glenelg_set2_tab$model <- gsub("fox_predicted", "fox_occ", glenelg_set2_tab$model)
glenelg_set2_tab$model <- gsub(", k = 3", "", glenelg_set2_tab$model)
# make table
kbl(glenelg_set2_tab, booktabs = TRUE, longtable = TRUE, digits  =2,
       col.names = c("Model", "K", "logLik", "AIC", "AICc", "dAICc", "AICcwt"),
    caption = "Akaike's Information Criterion values adjusted for small sample size for feral cat density models in the Glenelg region; model set 3.") %>% 
   kable_styling(font_size = 10) %>% 
footnote(general = c("K - number of parameters", 
                     "AICc - Akaike's Information Criterion with small-sample adjustment",
                     "dAICc - difference between AICc of this model and the model with smallest AICc",
                     "AICcwt - AICc model weight",
                     "fox_occ - fine-scale occurrence probability of foxes derived from generalised additive models",
                     "s(fox_occ) - non-linear smooth of fox_occ with three knots"),
         general_title = "")
```


\newpage

$~$

$~$

$~$

```{r density-aic-g-4}
## set 4
glenelg_set3_tab <- AIC(glenelg_set3, criterion = "AICc")[,-2]
rownames(glenelg_set3_tab) <- NULL
glenelg_set3_tab$model <- gsub("predicted_trapcov", "occ", glenelg_set3_tab$model)
glenelg_set3_tab$model <- gsub("fox_predicted", "fox_occ", glenelg_set3_tab$model)
# make table
kbl(glenelg_set3_tab, booktabs = TRUE, longtable = TRUE, digits  =2,
       col.names = c("Model", "K", "logLik", "AIC", "AICc", "dAICc", "AICcwt"),
    caption = "Akaike's Information Criterion values adjusted for small sample size for feral cat density models in the Glenelg region; model set 4.") %>% 
   kable_styling(font_size = 10) %>% 
footnote(general = c("K - number of parameters", 
                     "AICc - Akaike's Information Criterion with small-sample adjustment",
                     "dAICc - difference between AICc of this model and the model with smallest AICc",
                     "AICcwt - AICc model weight",
                     "fox_occ - fine-scale occurrence probability of foxes derived from generalised additive models",
                     "session - landscape (n = 6)"),
         general_title = "")
```


\newpage

$~$

$~$

$~$

```{r density-landscape-est}

estimate <- as.data.frame(unlist(sapply(predict(glenelg_fits$fit_sess2), "[", "D","estimate")))
names(estimate)[1] <- "estimate"
estimate <- tibble::rownames_to_column(estimate, "grid")
lower_bound <- as.data.frame(unlist(sapply(predict(glenelg_fits$fit_sess2), "[", "D","lcl")))
names(lower_bound)[1] <- "lcl"
lower_bound <- tibble::rownames_to_column(lower_bound, "grid")
upper_bound <- as.data.frame(unlist(sapply(predict(glenelg_fits$fit_sess2), "[", "D","ucl")))
names(upper_bound)[1] <- "ucl"
upper_bound <- tibble::rownames_to_column(upper_bound, "grid")
temp <- merge(lower_bound, upper_bound, by = "grid")
x <- merge(estimate, temp, by = "grid")
# rename grid
x$grid <- c("LGNP north", "LGNP south", "Annya","Cobboboonee", "Hotspur", "Mt Clay")
# add treatment variable
x$Treatment <- c("Non-impact", "Impact", "Non-impact", "Impact", "Non-impact", "Impact")
# add pair variable
x$Replicate <- c("3", "3", "1", "1", "2", "2")
# covert from hectares to km2
x$estimate <- x$estimate*100
x$lcl <- x$lcl*100
x$ucl <- x$ucl*100
x <- arrange(x, Replicate)

kbl(x, booktabs = TRUE, longtable = TRUE, digits  = 2,
       col.names = c("Landscape", "Estimate", "5% CI", "95% CI", "Treatment", "Replicate"),  
    caption = "Feral cat density per square kilometre as estimated by the AICc top-ranked model in the Glenelg region, Australia.") %>% 
   kable_styling(font_size = 10) 
```

\newpage


### Otway region 

$~$

$~$

$~$

```{r density-aic-o-1}
## set 1
df_fits_otways_aic <- AIC(df_fits_otways, criterion = "AICc")[,-2]
df_fits_otways_aic <- subset(df_fits_otways_aic, select = -c(model))
df_fits_otways_aic$logLik <- round(df_fits_otways_aic$logLik, digits = 2)
df_fits_otways_aic$AIC    <- round(df_fits_otways_aic$AIC, digits = 2)
df_fits_otways_aic$AICc   <- round(df_fits_otways_aic$AICc, digits = 2)
df_fits_otways_aic$dAICc   <- round(df_fits_otways_aic$dAICc, digits = 2)
df_fits_otways_aic$AICcwt  <- round(df_fits_otways_aic$AICcwt, digits = 2)
df_fits_otways_aic <- tibble::rownames_to_column(df_fits_otways_aic, "fit")
df_fits_otways_aic$fit <- ifelse(df_fits_otways_aic$fit == "fit1_ex", "exponential", "half-normal")

# table
kbl(df_fits_otways_aic, booktabs = TRUE, longtable = TRUE, digits  =2,
       col.names = c("Detector function", "K", "logLik", "AIC", "AICc", "dAICc", "AICcwt"),
    caption = "Akaike's Information Criterion values for detector functions in the Otway region, Australia; model set 1.") %>% 
   kable_styling(font_size = 10) %>% 
footnote(general = c("K - number of parameters", 
                     "AICc - Akaike's Information Criterion with small-sample adjustment",
                     "dAICc - difference between AICc of this model and the model with smallest AICc",
                     "AICcwt - AICc model weight"),
         general_title = "")
```


\newpage

$~$

$~$

$~$

```{r density-aic-o-2}
## set 2
otways_set1_tab <- AIC(otways_set1, criterion = "AICc")[,-2]
rownames(otways_set1_tab) <- NULL
# make table
kbl(otways_set1_tab, booktabs = TRUE, longtable = TRUE, digits  =2,
       col.names = c("Model", "K", "logLik", "AIC", "AICc", "dAICc", "AICcwt"),
    caption = "Akaike's Information Criterion values adjusted for small sample size for feral cat density models in the Otway region; model set 2.") %>% 
   kable_styling(font_size = 10) %>% 
footnote(general = c("K - number of parameters", 
                     "AICc - Akaike's Information Criterion with small-sample adjustment",
                     "dAICc - difference between AICc of this model and the model with smallest AICc",
                     "AICcwt - AICc model weight",
                     "T - linear time trend (g0 only)"),
         general_title = "")

```

\newpage

$~$

$~$

$~$

```{r density-aic-o-3}
## set 3
otways_set2_tab <- AIC(otways_set2, criterion = "AICc")[,-2]
rownames(otways_set2_tab) <- NULL
otways_set2_tab$model <- gsub("predicted_trapcov", "occ", otways_set2_tab$model)
otways_set2_tab$model <- gsub("fox_predicted", "fox_occ", otways_set2_tab$model)
otways_set2_tab$model <- gsub(", k = 3", "", otways_set2_tab$model)

# make table
kbl(otways_set2_tab, booktabs = TRUE, longtable = TRUE, digits  =2,
       col.names = c("Model", "K", "logLik", "AIC", "AICc", "dAICc", "AICcwt"),
    caption = "Akaike's Information Criterion values adjusted for small sample size for feral cat density models in the Otway region; model set 3.") %>% 
   kable_styling(font_size = 10) %>% 
footnote(general = c("K - number of parameters", 
                     "AICc - Akaike's Information Criterion with small-sample adjustment",
                     "dAICc - difference between AICc of this model and the model with smallest AICc",
                     "AICcwt - AICc model weight",
                     "fox_occ - fine-scale occurrence probability of foxes derived from generalised additive models",
                     "s(fox_occ) - non-linear smooth of fox_occ with three knots"),
         general_title = "")
```


\newpage

$~$

$~$

$~$

```{r density-aic-o-4}
## set 4
otways_set3_tab <- AIC(otways_set3, criterion = "AICc")[,-2]
rownames(otways_set3_tab) <- NULL
otways_set3_tab$model <- gsub("predicted_trapcov", "occ", otways_set3_tab$model)
otways_set3_tab$model <- gsub("fox_predicted", "fox_occ", otways_set3_tab$model)
# make table
kbl(otways_set3_tab, booktabs = TRUE, longtable = TRUE, digits  =2,
       col.names = c("Model", "K", "logLik", "AIC", "AICc", "dAICc", "AICcwt"),
    caption = "Akaike's Information Criterion values adjusted for small sample size for feral cat density models in the Otway region; model set 4.") %>% 
   kable_styling(font_size = 10) %>% 
footnote(general = c("K - number of parameters", 
                     "AICc - Akaike's Information Criterion with small-sample adjustment",
                     "dAICc - difference between AICc of this model and the model with smallest AICc",
                     "AICcwt - AICc model weight",
                     "fox_occ - fine-scale occurrence probability of foxes derived from generalised additive models",
                     "session - landscape by year (n = 6)"),
         general_title = "")
```

\newpage

$~$

$~$

$~$

```{r density-aic-o-5}
## Extract estimates
estimate <- as.data.frame(unlist(sapply(predict(otways_fits$fit_sess2), "[", "D","estimate")))
names(estimate)[1] <- "estimate"
estimate <- tibble::rownames_to_column(estimate, "grid")
lower_bound <- as.data.frame(unlist(sapply(predict(otways_fits$fit_sess2), "[", "D","lcl")))
names(lower_bound)[1] <- "lcl"
lower_bound <- tibble::rownames_to_column(lower_bound, "grid")
upper_bound <- as.data.frame(unlist(sapply(predict(otways_fits$fit_sess2), "[", "D","ucl")))
names(upper_bound)[1] <- "ucl"
upper_bound <- tibble::rownames_to_column(upper_bound, "grid")
temp <- merge(lower_bound, upper_bound, by = "grid")
fit_baci_vals <- merge(estimate, temp, by = "grid")
# rename grid
fit_baci_vals$grid <- gsub("session = ", "", fit_baci_vals$grid)
fit_baci_vals$grid <- substr(fit_baci_vals$grid, 0, 9)
new_grid_names <- c(mrch_n_17 = "north 2017", mrch_n_18 = "north 2018", mrch_n_19 = "north 2019", mrch_s_17 = "south 2017", mrch_s_18 = "south 2018", mrch_s_19 = "south 2019")
fit_baci_vals$grid <- as.character(new_grid_names[fit_baci_vals$grid])
# add treatment variable
fit_baci_vals$landscape <- c("Non-impact", "Non-impact", "Non-impact", "Impact", "Impact", "Impact")
fit_baci_vals$year <- c("2017", "2018", "2019", "2017", "2018", "2019")
# covert from hectares to km2
fit_baci_vals$estimate <- fit_baci_vals$estimate*100
fit_baci_vals$lcl <- fit_baci_vals$lcl*100
fit_baci_vals$ucl <- fit_baci_vals$ucl*100
fit_baci_vals <- arrange(fit_baci_vals, year)
# table
kbl(fit_baci_vals, booktabs = TRUE, longtable = TRUE, digits  = 2,
       col.names = c("Landscape", "Estimate", "5% CI", "95% CI", "Treatment", "Year"),  
    caption = "Feral cat density per square kilometre as estimated by the AICc top-ranked model in the Otway region, Australia.") %>% 
   kable_styling(font_size = 10) 

```


\newpage

